/**
 * The main plugin for FSQM Forms
 *
 * Handles all form related functions
 * Navigating to tabs, switching pages etc
 *
 * This is fired after Plugin UIF INIT
 *
 * @author     Swashata@iPanelThemes.com
 * @dependency jquery, jquery-sayt, ipt-plugin-uif-front-js
 *
 * @license    Themeforest Split License
 */
!function(t,i,e,s){"use strict";function n(i,e){this.element=i,this.jElement=t(i),this.settings=t.extend({},r,e),this._defaults=r,this._name=a,this.init()}var a="iptFSQMForm",r={propertyName:"value"};i.eFormreCaptchaLoad=function(){t(".ipt_fsqm_form").each(function(){var i=t(this),e=i.find(".g-recaptcha").eq(0),s=e.prev("input"),n=function(t){s.val(t),i.data("reCaptchaValidated",!0),i.find("form.ipt_uif_validate_form").validationEngine("hideAll")},a=function(){s.val(""),i.data("reCaptchaValidated",!1)};if(e.length){var r={sitekey:e.data("sitekey"),theme:e.data("theme"),type:e.data("type"),size:e.data("size"),callback:n,"expired-callback":a};grecaptcha.render(e.get(0),r)}i.data("reCaptchaValidated",!1)})},n.prototype={init:function(){var i=this,e=1==this.jElement.data("eformanim"),s=[];if(t("#ipt_fsqm_primary_css-css").length&&(s[s.length]={id:"ipt_fsqm_primary_css",src:iptFSQM.location+"css/form.css?version="+iptFSQM.version}),"undefined"!=typeof wp&&"undefined"!=typeof wp.customize){var n=this.jElement.find(".ipt_uif_init_loader .ipt_uif_ajax_loader_inner");return n.removeClass("ipt_uif_ajax_loader_animate"),n.find(".ipt_uif_ajax_loader_text").text(iptFSQM.l10n.customizer_msg),void(console&&console.warn&&console.warn("Customizer Detected. Shutting Down eForm"))}this.initBasicVariables(),this.applySayt(),this._restoreStopwatchVal(),this.jElement.iptPluginUIFFront({callback:function(){i.initVariables(),i.applyFSQM(),i._saytRestoreTab(),i.applyGoogleAnalytics(),i.applyLogins()},additionalThemes:s,waypoints:e})},initBasicVariables:function(){this.main_tab=this.jElement.find(".ipt_fsqm_main_tab"),this.main_form=this.jElement.find("form.ipt_fsqm_main_form"),this.form_id=this.jElement.find('input[name="form_id"]').val(),this.data_id=this.jElement.find('input[name="data_id"]').val(),this.restore_block=this.jElement.find(".ipt_fsqm_form_message_restore"),this.validation_block=this.jElement.find(".ipt_fsqm_form_validation_error"),this.interval_save_button=this.jElement.find(".ipt_fsqm_form_button_interval_save"),this.sayt_settings=this.jElement.data("fsqmsayt"),this.formReset=this.jElement.data("fsqmreset"),this.regSettings=this.jElement.data("eformreg"),this.eFormCookie=this.jElement.data("eformCookie"),this.reCaptchaNeeded=!1,this.jElement.find(".ipt_fsqm_container_recaptcha").length&&(this.reCaptchaNeeded=!0)},initVariables:function(){this.main_pb=this.jElement.find(".ipt_fsqm_main_pb"),this.button_container=this.jElement.find(".ipt_fsqm_form_button_container"),this.prev_button=this.button_container.find(".ipt_fsqm_form_button_prev"),this.next_button=this.button_container.find(".ipt_fsqm_form_button_next"),this.submit_button=this.button_container.find(".ipt_fsqm_form_button_submit"),this.reset_button=this.button_container.find(".ipt_fsqm_form_button_reset"),this.terms_wrap=this.jElement.find(".ipt_fsqm_terms_wrap"),this.tabIndices=this.main_tab.find("ul.ui-tabs-nav").eq(0).find("> li"),this.process=this.jElement.find(".ipt_fsqm_form_message_process"),this.success=this.jElement.find(".ipt_fsqm_form_message_success"),this.http_error=this.jElement.find(".ipt_fsqm_form_message_error"),this.timerTabFormSync={timerEnabled:!1,forceProgress:!1,forceSubmit:!1},this.nonce_interval=s,this.ga_tracker_name="",this.ga_cache={},this.fsqm_ga_data=this.jElement.data("fsqmga"),this.ui_type=this.jElement.data("uiType"),this.hidden_button=this.jElement.data("hiddenButtons"),this.tab_settings=this.main_tab.data("settings"),this.scroll_settings=this.jElement.data("eformscroll"),this.fsqm_submitting=!1,this.skipping_tab_for_conditional=!1,this.restoring_form=!1,this.sayt_restoring_tab=!1,this.jumping_on_button=!1,this.changing_tab_on_submit_error=!1,this.changing_tab_on_timer=!1,this.auto_progressing=!1,this.auto_progress_timer=!1,this.sayt_interval_saving=!1,this.on_last_page=!1,this.main_tab.length||(this.on_last_page=!0),this.block_prev_on_timer=!1},applyLogins:function(){if(this.regSettings){var t;if(!0===iptFSQM.core.logged_in&&!0===this.regSettings.enabled&&(this.jElement.find("#ipt_fsqm_form_"+this.form_id+"_pinfo_"+this.regSettings.username_id).hide(),this.jElement.find("#ipt_fsqm_form_"+this.form_id+"_pinfo_"+this.regSettings.password_id).hide(),!0===this.regSettings.hide_pinfo&&(this.jElement.find(".ipt_fsqm_container_f_name").hide(),this.jElement.find(".ipt_fsqm_container_l_name").hide(),this.jElement.find(".ipt_fsqm_container_email").hide()),!0===this.regSettings.hide_meta))for(t in this.regSettings.meta)this.jElement.find("#ipt_fsqm_form_"+this.form_id+"_"+this.regSettings.meta[t].m_type+"_"+this.regSettings.meta[t].key).hide()}},applyGoogleAnalytics:function(){var n=this,a="",r={mcq:"Multiple Choice Questions (M)",freetype:"Feedback and Upload (F)",pinfo:"Other Form Elements (O)"},o={mcq:"M",freetype:"F",pinfo:"O"};if("object"==typeof this.fsqm_ga_data&&this.fsqm_ga_data.enabled===!0&&(a=this.fsqm_ga_data.user_update===!0?"FSQM Update: "+this.fsqm_ga_data.form_id:"FSQM New Submission: "+this.fsqm_ga_data.form_id,i.ga!==s&&this.fsqm_ga_data.manual_load!==!0||""===this.fsqm_ga_data.tracking_id||!function(t,i,e,s,n,a,r){t.GoogleAnalyticsObject=n,t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},t[n].l=1*new Date,a=i.createElement(e),r=i.getElementsByTagName(e)[0],a.async=1,a.src=s,r.parentNode.insertBefore(a,r)}(i,e,"script","https://www.google-analytics.com/analytics.js","ga"),i.ga!==s)){ga("create",{trackingId:this.fsqm_ga_data.tracking_id,cookieDomain:this.fsqm_ga_data.cookie,name:"FSQM"+this.fsqm_ga_data.form_id}),this.ga_tracker_name="FSQM"+this.fsqm_ga_data.form_id+".";var _={dimension1:"",dimension2:"",dimension3:"",dimension4:""};ga(this.ga_tracker_name+"send","pageview"),this.jElement.on("tabsactivate",function(t,i){if(!(n.skipping_tab_for_conditional||n.restoring_form||n.sayt_restoring_tab||n.changing_tab_on_submit_error)){var e=n.tabIndices.index(i.oldTab),s=i.oldTab.text();ga(n.ga_tracker_name+"send","event",a,"Pagination",s,{dimension5:e.toString()})}}),this.jElement.on("blur change",".ipt_uif_conditional",function(i){if(i.originalEvent!==s){var e=t(this),m=e.prev().prev().val();if(t.inArray(m,["mcq","freetype","pinfo"])!=-1){var l=t(this).find(".check_me"),h=!1,f=e.prev().val(),c=/ipt_fsqm_form_([0-9]+)_(mcq|freetype|pinfo)_([0-9]+)/gi.exec(e.attr("id")),d=c[3],p=n._getElementValues(e,f),u=e.find("> .ipt_uif_column_inner > .ipt_uif_question > .ipt_uif_question_label > .ipt_uif_question_title").length?e.find("> .ipt_uif_column_inner > .ipt_uif_question > .ipt_uif_question_label > .ipt_uif_question_title"):e.find("label").eq(0),g="("+o[m]+"){"+d+"} "+u.text();if(p===!1||p===s)return;l.length&&(h=l.validationEngine("validateSilent"));var b="Completed";h===!0&&(b="Skipped"),p="object"==typeof p?p.join(", "):p.toString(),_.dimension1=r[m],_.dimension2=f,_.dimension3=d,_.dimension4=p,ga(n.ga_tracker_name+"send","event",a,b,g,_)}}}),this.jElement.on("submit",function(){ga(n.ga_tracker_name+"send","event",a,"Submit",n.fsqm_ga_data.name)})}},applySayt:function(){if("undefined"!=typeof t.fn.sayt){var e=this;if(this.sayt_settings===s||this.sayt_settings.admin_override!==!1||this.sayt_settings.user_update!==!1||this.sayt_settings.auto_save!==!0)return void this.restore_block.hide();this.sayt_settings.restore===!0&&this.main_form.sayt({autosave:!1,checksaveexists:!0})===!0?(this.main_form.sayt({recover:!0}),this.sayt_settings.show_restore&&(this.restore_block.fadeIn("fast"),this.restore_block.on("click",".ipt_fsqm_form_message_close",function(t){t.preventDefault(),e.restore_block.slideUp("fast")}))):this.restore_block.hide(),!0===this.sayt_settings.interval_save?(this.sayt_settings.interval>0&&(this.saytIntervalID=i.setInterval(function(){e.saytManualSave()},1e3*this.sayt_settings.interval)),this.interval_save_button.length&&this.interval_save_button.on("click",function(i){i.preventDefault(),e.saytManualSave();var s=t(this);s.tooltipster("close"),setTimeout(function(){s.tooltipster("content",s.data("stitle")),s.tooltipster("open")},500)})):this.main_form.sayt({autosave:!0,autorecover:!1,days:30,exclude:[".ipt_fsqm_sayt_exclude"]}),this.jElement.on("click",".ipt_fsqm_form_message_restore .ipt_fsqm_sayt_reset",function(i){i.preventDefault(),e._restoreForm(),t(this).closest(".ipt_fsqm_form_message_restore").slideUp("fast")})}},saytManualSave:function(){"undefined"!=typeof t.fn.sayt&&!0!==this.sayt_interval_saving&&(this.sayt_interval_saving=!0,this.main_form.sayt({autosave:!1,autorecover:!1,days:30,exclude:[".ipt_fsqm_sayt_exclude"],savenow:!0}),this.sayt_interval_saving=!1)},applyFSQM:function(){this._refreshStartupTimer(),this.applyFormEvents(),this.applyTimerEvent(),this.applyTabEvents(),this.applyAutoProgress(),this.applyNonceEvents(),this.applyCoupons(),this.applyStopwatch(),this.applyIntervalTooltipster()},applyIntervalTooltipster:function(){if(this.interval_save_button.length){var t=this.interval_save_button,i=this.interval_save_button.tooltipster("instance");i.on("closing",function(){t.tooltipster("content",t.data("otitle"))})}},applyStopwatch:function(){var t=this.jElement.find(".ipt_fsqm_form_stopwatch"),i=this.jElement.find(".ipt_fsqm_form_stopwatch_val");t.length&&t.TimeCircles().addListener(function(t,e,s){i.val(s)},"all")},applyCoupons:function(){var i=this.jElement.find(".ipt_uif_coupon_button");0!==i.length&&(i.on("click",function(i){i.preventDefault();var e=t(this).prop("disabled",!0),s=t(this).closest(".ipt_uif_coupon"),n=s.data("config"),a=s.find(".ipt_uif_coupon_message"),r=s.find(".ipt_uif_mathematical_input");return e.find(".ui-button-text").html(n.wait),a.html(""),""===s.find(".ipt_uif_coupon_text").val()?(e.prop("disabled",!1),e.find(".ui-button-text").html(n.normal),r.data("formula",r.attr("data-formula")),s.find(".ipt_uif_coupon_final").trigger("fsqm.mathematicalReEvaluate"),void s.trigger("fsqm.conditional")):void t.get(iptFSQM.ajaxurl,{action:n.action,_wpnonce:n.cnonce,form_id:n.form_id,coupon:s.find(".ipt_uif_coupon_text").val(),amount:s.closest(".ipt_fsqm_container_payment").find(".ipt_fsqm_payment_mathematical .ipt_uif_mathematical_input").val()},function(t){a.html(t.msg).removeClass("msg_okay").removeClass("msg_error"),t.success===!0?(a.addClass("msg_okay"),r.data("formula",t.formula)):(a.addClass("msg_error"),r.data("formula",r.attr("data-formula")))}).fail(function(){a.addClass("msg_error"),r.data("formula",r.attr("data-formula")),alert(n.http_error)}).always(function(){e.prop("disabled",!1),e.find(".ui-button-text").html(n.normal),s.find(".ipt_uif_coupon_final").trigger("fsqm.mathematicalReEvaluate"),s.trigger("fsqm.conditional")})}),this.jElement.find(".ipt_uif_coupon_text").on("keyup keypress",function(t){var e=t.keyCode||t.which;if(13===e)return t.preventDefault(),i.trigger("click"),!1}),this.jElement.find(".ipt_uif_coupon_final").on("change",function(){i.trigger("click")}))},applyNonceEvents:function(){if(this.jElement.find('input[name="form_id"]').length){var i=this.data_id===s?null:this.data_id,e=this.jElement.find('input[name="ipt_fsqm_form_data_save"]'),n=this.jElement.find('input[name="ipt_fsqm_user_edit_nonce"]'),a=this.jElement.find('input[name="user_edit"]'),r={form_id:this.form_id,action:"ipt_fsqm_refresh_nonce"};null!==i&&(r.data_id=i),a.length&&(r.user_edit="1");var o=function(){t.post(iptFSQM.ajaxurl,r,function(t,i,s){"object"==typeof t&&t.success===!0&&(e.val(t.save_nonce),n.length&&n.val(t.edit_nonce))})};o(),this.nonce_interval=setInterval(o,36e5)}},applyAutoProgress:function(){if(this.tab_settings!==s&&this.tab_settings.auto_progress===!0&&this.main_tab.length){var i=this;this.jElement.on("blur change",".check_me",t.debounce(250,function(){if(i.auto_progressing!==!0){i.auto_progress_timer!==!1&&(clearTimeout(i.auto_progress_timer),i.auto_progress_timer=!1);var e=parseInt(i.tab_settings.auto_progress_delay,10);(s===e||isNaN(e))&&(e=1500);var n=!0;i.main_tab.find('> div.ui-tabs-panel[aria-hidden="false"] .check_me').each(function(){if(t(this).validationEngine("validateSilent")===!0)return n=!1,!1}),n===!0&&(i.on_last_page!==!0?i.auto_progress_timer=setTimeout(function(){i.auto_progressing=!0,i._navigateNextTab(),i.auto_progressing=!1,i.auto_progress_timer=!1},e):i.auto_progress_timer=setTimeout(function(){i.auto_progress_timer=!1,i.terms_wrap.length&&i.terms_wrap.find(".check_me").validationEngine("validateSilent")===!0||i.tab_settings.auto_submit===!0&&i.main_form.submit()},e))}}))}},applyFormEvents:function(){var i=this;this.main_form.on("submit",function(e){e.preventDefault();var s=!0;if(i.timerTabFormSync.timerEnabled===!0&&i.timerTabFormSync.forceSubmit===!0)return void i._processSubmission();if(i.on_last_page!==!0)return void i._navigateNextTab();if(i._openRequiredCollapsedElements(i.main_form),0!==i.main_tab.length){if(i.main_tab.find('> div.ui-tabs-panel[aria-hidden="false"] .check_me').each(function(){if(!0===t(this).validationEngine("validate"))return s=!1,i._scrollToPosition(t(this),200,80),!1}),s===!1)return!1;if(i.terms_wrap.length&&i.terms_wrap.find(".check_me").validationEngine("validate"))return!1}else if(i.main_form.validationEngine("validate")===!1)return!1;return i._checkUploadRequests(i.main_form)!==!1&&(0!=i._checkForReCaptcha()&&(i._processSubmission(),i._destroyTimer(!0),!0))})},applyTabEvents:function(){var i=this;return this.jElement.on("click",".ipt_fsqm_jump_button",function(e){return e.preventDefault(),!!i.main_tab.length&&(i.jumping_on_button=!0,i.main_tab.tabs("option","active",t(this).data("pos")-1),void(i.jumping_on_button=!1))}),this._onResetButton(),this.main_tab.length?(2==this.tab_settings.type&&this.main_tab.find("ul.ui-tabs-nav").eq(0).hide(),this._initButtonsForTab(),this.main_tab.on("tabsbeforeactivate",function(e,s){if(i.main_tab.is(t(e.target))){var n=i.tabIndices.index(s.oldTab),a=i.tabIndices.index(s.newTab),r=!0;if(i.skipping_tab_for_conditional===!0)return!0;if(i.restoring_form===!0)return i._skipTabIfNecessary(s,a,n)!==!0;if(i.sayt_restoring_tab===!0)return i._skipTabIfNecessary(s,a,n)!==!0;if(i.jumping_on_button===!0&&i.timerTabFormSync.timerEnabled!==!0)return i._skipTabIfNecessary(s,a,n)!==!0;if(i.changing_tab_on_submit_error===!0)return i._skipTabIfNecessary(s,a,n)!==!0;if(1==i.tab_settings.any_tab)return i._skipTabIfNecessary(s,a,n)!==!0;if(1==i.changing_tab_on_timer)return i._skipTabIfNecessary(s,a,n)!==!0;if(a>n&&i.next_button.hasClass("iptUIFCHidden"))return!1;if(a>n&&a-n>1)return i._navigateNextTab(),!1;if(a<n){if(i.tab_settings.block_previous===!0||i.block_prev_on_timer===!0)return!1;if(i.tab_settings.can_previous===!0)return i._skipTabIfNecessary(s,a,n)!==!0}return i.timerTabFormSync.forceProgress===!0&&i.timerTabFormSync.timerEnabled===!0?i._skipTabIfNecessary(s,a,n)!==!0:(i._openRequiredCollapsedElements(s.oldPanel),s.oldPanel.find(".check_me").each(function(){if(!0===t(this).validationEngine("validate")){var e=t(this);return r=!1,i.tab_settings.scroll_on_error&&i._scrollToPosition(t(this),200,80),(e.hasClass("ipt_uif_text")||e.hasClass("ipt_uif_textarea"))&&e.addClass("invalid").removeClass("valid"),!1}}),r!==!1&&(i._checkUploadRequests(s.oldPanel)!==!1&&(0!=i._checkForReCaptcha()&&i._skipTabIfNecessary(s,a,n)!==!0)))}}),this.main_tab.on("tabsactivate",function(e,s){if(i.main_tab.is(t(e.target))){var n=i.tabIndices.index(s.newTab);if(2==i.tab_settings.type&&i.tab_settings.show_progress_bar===!0){var a=n/i.tabIndices.length*100;a=+a.toFixed(i.tab_settings.decimal_point),i.main_pb.progressbar("option","value",a)}i.main_form.find(".ipt_fsqm_form_tab_pos").val(n).trigger("change"),i._refreshButtonsForTab(),i._scrollToTab(),Cookies.set("eform-quiz-tab-"+i.form_id,n,{expires:30,path:""})}}),void this.main_tab.on("iptUIFCHide iptUIFCShow",'[role="tab"]',function(){i._refreshButtonsForTab()})):void(this.on_last_page=!0)},applyTimerEvent:function(){if("undefined"!=typeof t.fn.TimeCircles){var n=this,a=this.jElement.find(".ipt_fsqm_timer_data").val();if(null!==a&&""!==a&&a!==s&&(this.timerVar=t.parseJSON(a),this.timerOuterDIV=this.jElement.find(".ipt_fsqm_timer"),this.timerDIV=this.timerOuterDIV.find("> .ipt_fsqm_timer_inner"),this.timerSpacer=this.timerOuterDIV.next(".ipt_fsqm_timer_spacer"),null!==this.timerVar&&this.timerVar&&(this.timerTabFormSync.timerEnabled=!0,this.timerTabFormSync.timerVar=this.timerVar,this._initTimer(),"overall"==this.timerVar.type||"page_specific"==this.timerVar.type))){var r=function(){var e=t(i).scrollTop(),s=e+t(i).height(),a=n.jElement.offset(),r=a.top+10,o=r+n.jElement.outerHeight()+90;s>=r&&o>=s?n.timerOuterDIV.hasClass("fixed")||(n.timerOuterDIV.appendTo("body"),n.timerDIV.TimeCircles().rebuild(),n.timerOuterDIV.addClass("fixed")):n.timerOuterDIV.hasClass("fixed")&&(n.timerOuterDIV.insertBefore(n.timerSpacer),n.timerDIV.TimeCircles().rebuild(),n.timerOuterDIV.removeClass("fixed"))};t(e).on("scroll",t.debounce(250,r)),r(),t(i).on("resize iptUIFCShow iptUIFCHide tabsactivate",t.debounce(250,function(){r(),n.timerDIV.TimeCircles().rebuild()}))}}},_initTimer:function(){var i,e,n,a,r=this;if(this._reInitTimer(),"overall"==this.timerVar.type)0===this.timerVar.time||""===this.timerVar.time||isNaN(this.timerVar.time)?this._destroyTimer():(a=this._getPersistentTime(),s!=a?this.timerDIV.data("timer",this._sanitizePersistentTime(a,this.timerVar.time)):this.timerDIV.data("timer",this.timerVar.time),this.timerDIV.TimeCircles({time:{Days:{show:!1},Hours:{text:iptPluginUIFFront.L10n.timer.Hours},Minutes:{text:iptPluginUIFFront.L10n.timer.Minutes},Seconds:{text:iptPluginUIFFront.L10n.timer.Seconds}},total_duration:"Auto",count_past_zero:!1}).addListener(function(t,i,e){Cookies.set("eform-quiz-time-"+r.form_id,e,{expires:30,path:""}),e<=0&&r._progressTimerPage()}));else if("page_specific"==this.timerVar.type){n=0;for(i in this.timerVar.time)e=parseFloat(this.timerVar.time[i]),isNaN(e)&&(e=0),t("#ipt_fsqm_form_"+r.form_id+"_tab_"+i).data("ipt_fsqm_timer",e),n+=e;this.main_tab.length?(this.block_prev_on_timer=!0,this.initialTabTimerRestore=!0,this._restoreTimerTabPosition()||(this._activeTabTimer(),r.initialTabTimerRestore=!1),this.__activeTabTimerRef=function(){r._activeTabTimer(),r.initialTabTimerRestore=!1},this.main_tab.on("tabsactivate",this.__activeTabTimerRef)):0===n||""===n||isNaN(n)?this._destroyTimer():(a=this._getPersistentTime(),s!=a?this.timerDIV.data("timer",this._sanitizePersistentTime(a,n)):this.timerDIV.data("timer",n),this.timerDIV.TimeCircles({time:{Days:{show:!1},Hours:{text:iptPluginUIFFront.L10n.timer.Hours},Minutes:{text:iptPluginUIFFront.L10n.timer.Minutes},Seconds:{text:iptPluginUIFFront.L10n.timer.Seconds}},total_duration:"Auto",count_past_zero:!1}).addListener(function(t,i,e){Cookies.set("eform-quiz-time-"+r.form_id,e,{expires:30,path:""}),e<=0&&r._progressTimerPage()}))}else this._destroyTimer()},_restoreTimerTabPosition:function(){var t=Cookies.get("eform-quiz-tab-"+this.form_id);return s!==t&&0!=t&&(this.changing_tab_on_timer=!0,this.main_tab.tabs("option","active",t),this.changing_tab_on_timer=!1,!0)},_getPersistentTime:function(){var t=Cookies.get("eform-quiz-time-"+this.form_id);return s==t?s:(t=parseInt(t,10),isNaN(t)?s:t)},_sanitizePersistentTime:function(t,i){return t<=0?(this._progressTimerPage(),0):(t>i&&(t=i),t)},_activeTabTimer:function(){var t=this,i=this.main_tab.find(".ui-tabs-panel").eq(this.main_tab.tabs("option","active")),e=parseFloat(i.data("ipt_fsqm_timer"));if(this.timerDIV.TimeCircles().destroy(),0===e||isNaN(e))this._destroyTimer(!1);else{if(this._reInitTimer(),1==this.initialTabTimerRestore){var n=this._getPersistentTime();s!==n?this.timerDIV.data("timer",this._sanitizePersistentTime(n,e)):this.timerDIV.data("timer",e)}else this.timerDIV.data("timer",e);this.timerDIV.TimeCircles({time:{Days:{show:!1},Hours:{text:iptPluginUIFFront.L10n.timer.Hours},Minutes:{text:iptPluginUIFFront.L10n.timer.Minutes},Seconds:{text:iptPluginUIFFront.L10n.timer.Seconds}},total_duration:"Auto",count_past_zero:!1}).addListener(function(i,e,s){Cookies.set("eform-quiz-time-"+t.form_id,s,{expires:30,path:""}),s<=0&&t._progressTimerPage()})}},_destroyTimer:function(t){if(t=s!==t&&t,this.timerVar){this.timerDIV.hide().parent().hide().next(".ipt_fsqm_timer_spacer").hide(),this.timerTabFormSync.timerEnabled=!1,this.timerTabFormSync.forceProgress=!1,this.timerTabFormSync.forceSubmit=!1,t&&this.main_tab.length&&this.__activeTabTimerRef&&this.main_tab.off("tabsactivate",this.__activeTabTimerRef);try{this.timerDIV.TimeCircles().destroy()}catch(t){}Cookies.remove("eform-quiz-time-"+this.form_id,{expires:30,path:""}),Cookies.remove("eform-quiz-tab-"+this.form_id,{expires:30,path:""})}},_reInitTimer:function(){this.timerVar&&(this.timerDIV.show().parent().show().next(".ipt_fsqm_timer_spacer").show(),this.timerTabFormSync.timerEnabled=!0,this.timerTabFormSync.forceProgress=!1,this.timerTabFormSync.forceSubmit=!1)},_progressTimerPage:function(){if(this.timerVar)return this.fsqm_submitting===!0?(this._destroyTimer(!0),!1):void(this.on_last_page||"overall"==this.timerVar.type?(this.timerTabFormSync.forceProgress=!1,this.timerTabFormSync.forceSubmit=!0,this.main_form.submit(),this._destroyTimer(!0)):(this.timerTabFormSync.forceProgress=!0,this.timerTabFormSync.forceSubmit=!1,this._navigateNextTab(),this.timerTabFormSync.forceProgress=!1))},_navigateNextTab:function(){if(this.on_last_page)return!1;var t=this.tabIndices.index(this.tabIndices.filter('[aria-selected="true"]').next("li"));return t!==-1&&(this.main_tab.tabs("option","active",t),!0)},_navigatePrevTab:function(){if(this.on_first_page)return!1;var t=this.tabIndices.index(this.tabIndices.filter('[aria-selected="true"]').prev("li"));return t!==-1&&(this.main_tab.tabs("option","active",t),!0)},_onResetButton:function(){var t=this,i=t.jElement.find(".ipt_fsqm_form_button_container .ipt_fsqm_form_button_reset");i.length&&i.on("click",function(i){i.preventDefault();var e=confirm(iptFSQM.l10n.reset_confirm);e&&(t._restoreForm(),t.jElement.find(".ipt_fsqm_form_message_restore").hide(),t._scrollToPosition(t.jElement,200,10))})},_initButtonsForTab:function(){var t=this;1===this.tabIndices.length?(this.prev_button.remove(),this.next_button.remove(),this.submit_button.button("enable")):(this.prev_button.button("disable"),this.submit_button.button("disable"),this.next_button.button("enable"),this.terms_wrap.hide(),this.prev_button.on("click",function(i){i.preventDefault(),t._navigatePrevTab()}),this.next_button.on("click",function(i){i.preventDefault(),t._navigateNextTab()})),this._refreshButtonsForTab()},_changePrevButton:function(t){return t===s&&(t=!1),this.tab_settings.block_previous===!0||this.block_prev_on_timer?void this.prev_button.stop(!0,!0).hide():void(t?(this.prev_button.button("enable"),this.tab_settings.hidden_buttons&&!this.prev_button.hasClass("iptUIFCHidden")&&this.prev_button.stop(!0,!0).fadeIn("fast")):(this.prev_button.button("disable"),this.tab_settings.hidden_buttons&&!this.prev_button.hasClass("iptUIFCHidden")&&this.prev_button.stop(!0,!0).hide()))},_changeNextButton:function(t){t===s&&(t=!1),t?(this.next_button.button("enable"),this.tab_settings.hidden_buttons&&!this.next_button.hasClass("iptUIFCHidden")&&this.next_button.stop(!0,!0).fadeIn("fast")):(this.next_button.button("disable"),this.tab_settings.hidden_buttons&&!this.next_button.hasClass("iptUIFCHidden")&&this.next_button.stop(!0,!0).hide())},_changeSubmitButton:function(t){t===s&&(t=!1),t?(this.submit_button.button("enable"),this.tab_settings.hidden_buttons&&!this.submit_button.hasClass("iptUIFCHidden")&&this.submit_button.stop(!0,!0).fadeIn("fast")):(this.submit_button.button("disable"),this.tab_settings.hidden_buttons&&!this.submit_button.hasClass("iptUIFCHidden")&&this.submit_button.stop(!0,!0).hide())},_changeTermsWrap:function(t){t===s&&(t=!1),t?this.terms_wrap.show():this.terms_wrap.hide()},_refreshButtonsForTab:function(){for(var t=this.main_tab.tabs("option","active"),i=this.tabIndices.length,e=0,s=i-1;this.tabIndices.eq(e).hasClass("iptUIFCHidden");)if(e++,e>=i){e=i-1;break}for(;this.tabIndices.eq(s).hasClass("iptUIFCHidden");)if(s--,s<0){s=i-1;break}t==s?(t!=e?this._changePrevButton(!0):this._changePrevButton(!1),this._changeNextButton(!1),this._changeSubmitButton(!0),this._changeTermsWrap(!0),this.on_last_page=!0,this.on_first_page=!1):t==e?(this._changePrevButton(!1),this._changeNextButton(!0),this._changeSubmitButton(!1),this._changeTermsWrap(!1),this.on_last_page=!1,this.on_first_page=!0):(this._changePrevButton(!0),this._changeNextButton(!0),this._changeSubmitButton(!1),this._changeTermsWrap(!1),this.on_last_page=!1,this.on_first_page=!1)},_refreshStartupTimer:function(){if(this.jElement.find(".ipt_fsqm_form_startup_timer").length){var t=this.jElement.find(".ipt_fsqm_form_startup_timer").TimeCircles();t.addListener(function(t,e,s){s<=0&&i.location.reload(!0)})}},_skipTabIfNecessary:function(t,i,e){this.skipping_tab_for_conditional=!0;var s=!1;if(t.newTab.hasClass("iptUIFCHidden")){var n=null;if(i<e)for(n=t.newTab.prev("li");n.hasClass("iptUIFCHidden")&&(n=n.prev("li"),n.length););else for(n=t.newTab.next("li");n.hasClass("iptUIFCHidden")&&(n=n.next("li"),n.length););var a=this.tabIndices.index(n);a!=-1&&this.main_tab.tabs("option","active",a),s=!0}return this.skipping_tab_for_conditional=!1,s},_restoreForm:function(){this.restoring_form=!0,this.main_form.trigger("reset"),this.main_form.find(".ipt_uif_slider, .ipt_uif_slider_range_max").val("0").trigger("fsqm.slider"),this.main_form.trigger("fsqm.mathematicalReEvaluate").trigger("fsqm.check_likedislike").trigger("fsqm.check_smiley"),this.main_form.find(".ipt_uif_jsignature_reset").trigger("click"),this.main_form.find(".ipt_uif_conditional").trigger("fsqm.conditional"),this.main_tab.length&&this.main_tab.tabs({active:0}),this.main_form.find(".ipt_fsqm_form_tab_pos").val("0"),"undefined"!=typeof t.fn.sayt&&this.main_form.sayt({erase:!0}),this.restoring_form=!1,this.main_form.trigger("formReset.eform")},_saytRestoreTab:function(){if("undefined"!=typeof t.fn.sayt){if(this.sayt_restoring_tab=!0,this.sayt_settings!==s&&this.sayt_settings.admin_override===!1&&this.sayt_settings.auto_save===!0&&this.sayt_settings.restore===!0&&this.main_form.sayt({checksaveexists:!0})===!0){var i=this.main_form.find(".ipt_fsqm_form_tab_pos").val();this.main_tab.length&&i!==s&&this.main_tab.tabs({active:i})}this.sayt_restoring_tab=!1}},_restoreStopwatchVal:function(){var t=this.jElement.find(".ipt_fsqm_form_stopwatch"),i=this.jElement.find(".ipt_fsqm_form_stopwatch_val");t.length&&t.attr("data-timer",i.val())},_endStopwatch:function(t){t=s!==t&&t;var i=this.jElement.find(".ipt_fsqm_form_stopwatch");this.jElement.find(".ipt_fsqm_form_stopwatch_val");i.length&&(t?i.hide():i.TimeCircles().destroy())},_scrollToPosition:function(i,e,n){var a=i.offset().top,r=this.main_form.closest(".remodal-wrapper"),o=parseFloat(t("html").css("margin-top")),_=parseFloat(t("html").css("padding-top")),m=t("html, body");n===s&&(n=0),e===s&&(e=200),r.length?a=i.position().top-n-55:(isNaN(o)&&(o=0),isNaN(_)&&(_=0),a=a-o-_,a-=n),this.scroll_settings!==s&&(a-=this.scroll_settings.offset),a<0&&(a=0),r.length&&(m=r),0!==e?m.animate({scrollTop:a},e):m.scrollTop(a)},_scrollToTab:function(){this.tab_settings.scroll!==!1&&(2==this.tab_settings.type&&this.tab_settings.show_progress_bar===!0&&0==this.tab_settings.progress_bar_bottom?this._scrollToPosition(this.main_pb,200,10):this._scrollToPosition(this.main_tab,200,10))},_openRequiredCollapsedElements:function(i){i.find(".ipt_uif_collapsible").each(function(){var i=!1;t(this).find(".check_me").each(function(){if(t(this).attr("class").match(/required/))return i=!0,!1}),i&&!t(this).hasClass("ipt_uif_collapsible_open")&&t(this).find(">.ipt_uif_container_head > h3 > a").trigger("click")})},_checkUploadRequests:function(i){var e=this,s=!0;return i.find(".ipt_uif_uploader").each(function(){if(!t(this).is(":visible"))return!0;var i=t(this),n=i.data("activeUpload"),a=i.data("totalUpload"),r=i.data("settings");n>0&&(i.validationEngine("showPrompt",iptFSQM.l10n.uploader_active_upload,"red"),s=!1),r.required===!0&&a<1&&(i.validationEngine("showPrompt",iptFSQM.l10n.uploader_required,"red"),s=!1);var o=parseInt(r.min_number_of_files,10);return(isNaN(o)||o<0)&&(o=0),o>1&&a<o&&(i.validationEngine("showPrompt",iptFSQM.l10n.uploader_required_number+" "+o,"red"),s=!1),s===!1?(e._scrollToPosition(i,200,50),!1):void 0}),s},_processSubmission:function(){var e=this;this.main_form.hide(),this.restore_block.hide(),this.success.hide(),this.http_error.hide(),this.main_form.validationEngine("hideAll"),this.main_form.iptPluginUIFFront("refreshiFrames"),this.process.show();var n=this.process.find(".ipt_uif_ajax_loader_inline").css("width","auto"),a=this.process.width(),r=n.width()+50,o=n.height();e.scroll_settings&&1==e.scroll_settings.progress&&e._scrollToPosition(e.process,10,10),n.css({width:a,height:o,opacity:0}).animate({width:r,opacity:1},"normal"),this.fsqm_submitting=!0,this._endStopwatch(e.formReset&&e.formReset.reset);var _={action:this.main_form.find('[name="action"]').val(),ipt_ps_post:this.main_form.serialize(),ipt_ps_send_as_str:!0,ipt_ps_look_into:"ipt_ps_post"};t.post(iptFSQM.ajaxurl,_,function(n){if(null===n||0===n||"0"===n)return e.http_error.find(".textStatus").html("Null Data"),e.http_error.find(".errorThrown").html("Possible Server Error"),e.http_error.slideDown("fast"),e.main_form.show(),void(e.scroll_settings&&1==e.scroll_settings.message&&e._scrollToPosition(e.http_error,200,10));if(n.success===!0){if(e.success.find(".ui-widget-content.ipt_fsqm_success_wrap").html(n.msg),e.success.slideDown("fast",function(){if(e.scroll_settings&&1==e.scroll_settings.message&&e._scrollToPosition(e.success,200,10),n.components.redirect===!0){if(""!==n.components.redirect_msg&&(e.success.find(".ipt_fsqm_sm_meta").remove(),e.success.find(".ui-widget-content.ipt_fsqm_success_wrap").after('<div class="ui-widget-content ui-corner-all ipt_fsqm_sm_meta"><p class="ipt_fsqm_sm_meta_p">'+n.components.redirect_msg+"</p></div>")),e.success.find(".ipt_fsqm_redirection_countdown").length){var t=n.components.redirect_delay/1e3,s=new CountUp(e.success.find(".ipt_fsqm_redirection_countdown").get(0),t,0,0,t,{useEasing:!1,useGrouping:!0,separator:",",decimal:".",prefix:"",suffix:""});s.start()}setTimeout(function(){i.self!==i.top&&n.components.redirect_top?i.top.location.href=n.components.redirect_url:i.location.href=n.components.redirect_url},n.components.redirect_delay)}}),e.nonce_interval!==s&&clearInterval(e.nonce_interval),e.saytIntervalID&&i.clearInterval(e.saytIntervalID),"undefined"!=typeof t.fn.sayt&&e.main_form.sayt({erase:!0}),e.formReset&&e.formReset.reset&&n.components.redirect!==!0)if(e.formReset.delay>0){var a=new CountUp(e.success.find(".ipt_fsqm_form_reset_cu").get(0),e.formReset.delay,0,0,e.formReset.delay,{useEasing:!1,useGrouping:!0,separator:",",decimal:".",prefix:"",suffix:""});a.start(),setTimeout(function(){e._resetFormOnSubmit()},1e3*e.formReset.delay)}else e._resetFormOnSubmit();try{var r=parseInt(Cookies.get("eform-submission-"+e.form_id),10);isNaN(r)&&(r=0),Cookies.set("eform-submission-"+e.form_id,++r,{expires:365,path:iptFSQM.core.siteurl})}catch(t){console&&console.log&&console.log(t)}}else{if("object"==typeof n.errors){var o;for(o in n.errors)if("fsqm_email_limit"==n.errors[o].id||"fsqm_ip_limit"==n.errors[o].id)return e.validation_block.find(".fsqm_ve_text").html(n.errors[o].msgs[0]),e.validation_block.find(".fsqm_ve_msg").html(n.errors[o].msgs[1]),e.validation_block.show(),void e.validation_block.addClass("iptAnimated iptPulseSubtle")}if(e.main_form.show(),"object"==typeof n.errors){var _,m,l,h=!1;for(_=0;_<n.errors.length;_++)m=n.errors[_].msgs.join("<br />"),""!==n.errors[_].id?(l=t("#"+n.errors[_].id),l.length?(h=!0,l.validationEngine("showPrompt",m,"red"),l.closest(".ipt_uif_column_inner").css({position:"relative"})):e.main_form.validationEngine("showPrompt",m,"red")):e.main_form.validationEngine("showPrompt",m,"red");if(0!==e.main_tab.length){var f;if(e.main_tab.find("> .ipt_fsqm_form_tab_panel").each(function(){if(t(this).find(".formErrorContent").length)return f=t(this),!1}),f!==s&&f.length){
var c=e.tabIndices.index(e.tabIndices.filter('[aria-controls="'+f.attr("id")+'"]')),d=h;h=!1,e.changing_tab_on_submit_error=!0,e.main_tab.tabs("option","active",c),e.changing_tab_on_submit_error=!1,setTimeout(function(){e._scrollToPosition(f.find(".formErrorContent").eq(0),200,10),d&&alert(iptFSQM.l10n.validation_on_submit)},500)}}h&&alert(iptFSQM.l10n.validation_on_submit)}}},"json").fail(function(t,i,s){e.http_error.find(".textStatus").html(i),e.http_error.find(".errorThrown").html(s.message),e.http_error.slideDown("fast"),e.main_form.show(),e.scroll_settings&&1==e.scroll_settings.message&&e._scrollToPosition(e.http_error,200,10)}).always(function(){e.process.hide(),e.fsqm_submitting=!1})},_resetFormOnSubmit:function(){var t=this;this.timerVar&&(this._destroyTimer(),this._initTimer()),this.applyNonceEvents(),this._restoreForm(),this.jElement.find(".ipt_fsqm_form_message_restore").hide(),this.sayt_settings&&!0===this.sayt_settings.interval_save&&this.sayt_settings.interval>0&&(this.saytIntervalID=i.setInterval(function(){t.saytManualSave()},1e3*this.sayt_settings.interval)),this.main_form.fadeIn("fast"),this.restore_block.hide(),this.success.hide(),this.http_error.hide(),this._scrollToPosition(this.jElement,200,10),this.jElement.find(".ipt_fsqm_form_stopwatch_val").val(0);var e=this.jElement.find(".ipt_fsqm_form_stopwatch");e.length&&(e.show(),e.TimeCircles().restart())},_getElementValues:function(i,e){var n,a,r,o,_=[],m=this,l={frown:1,sad:2,neutral:3,happy:4,excited:5},h={like:1,dislike:0};switch(e){case"radio":case"p_radio":_=[],i.find("input.ipt_uif_radio").filter(":checked").each(function(){_[_.length]=jQuery.trim(t(this).next("label").text())});break;case"checkbox":case"p_checkbox":_=[],i.find("input.ipt_uif_checkbox").filter(":checked").each(function(){_[_.length]=jQuery.trim(t(this).next("label").text())});break;case"select":case"p_select":_=[],i.find("select.ipt_uif_select option").filter(":selected").each(function(){_[_.length]=jQuery.trim(t(this).text())});break;case"thumbselect":_=[],i.find("input.ipt_uif_radio, input.ipt_uif_checkbox").filter(":checked").each(function(){_[_.length]=jQuery.trim(t(this).data("label"))});break;case"slider":_=m.intelParseFloat(i.find("input.ipt_uif_slider").val());break;case"range":_=[m.intelParseFloat(i.find("input.ipt_uif_slider.slider_range").val()),m.intelParseFloat(i.find("input.ipt_uif_slider.slider_range").next("input").val())];break;case"spinners":_=[],i.find("input.ipt_uif_uispinner").each(function(){""!==t(this).val()&&(_[_.length]=m.intelParseFloat(t(this).val()))});break;case"grading":_=[],i.find("input.ipt_uif_slider").each(function(){""!==t(this).val()&&(_[_.length]=m.intelParseFloat(t(this).val())),t(this).hasClass("slider_range")&&t(this).next("input").val()&&(_[_.length]=m.intelParseFloat(t(this).next("input").val()))});break;case"starrating":case"scalerating":_=[],i.find(".ipt_uif_rating").each(function(){t(this).find("input.ipt_uif_radio:checked").length&&(_[_.length]=m.intelParseFloat(t(this).find("input.ipt_uif_radio:checked").val()))});break;case"matrix":_=[],a=[],i.find(".ipt_uif_matrix thead th").each(function(){a[a.length]=jQuery.trim(t(this).text())}),i.find(".ipt_uif_checkbox,.ipt_uif_radio").filter(":checked").each(function(){r=t(this).closest("tr").find("> *").index(t(this).closest("td")),""===a[r]&&a[r]===s||(_[_.length]=a[r])});break;case"toggle":case"s_checkbox":_=i.find('input[type="checkbox"]').is(":checked")?"1":"0";break;case"smileyrating":n=i.find('input[type="radio"]:checked').val(),l[n]!==s&&(_=l[n]);break;case"likedislike":n=i.find('input[type="radio"]:checked').val(),h[n]!==s&&(_=h[n]);break;case"matrix_dropdown":_=[],i.find("select").each(function(){o=t(this).find("option").filter(":selected"),""!==o.val()&&(_[_.length]=o.text())});break;case"feedback_small":case"f_name":case"l_name":case"email":case"phone":case"p_name":case"p_email":case"p_phone":case"textinput":case"password":case"keypad":case"datetime":_=i.find('input[type="text"]').val(),_===s&&"keypad"==e&&(_=i.find("textarea").val()),m.isNumeric(_)&&(_=m.intelParseFloat(_));break;case"feedback_large":case"textarea":_=i.find("textarea").val();break;case"upload":_=i.find(".ipt_uif_uploader").data("totalUpload");break;case"mathematical":_=m.intelParseFloat(i.find("input.ipt_uif_mathematical_input").val());break;case"address":_=[],i.find(".ipt_uif_text").each(function(){_[_.length]=t(this).val()});break;default:_=!1}return _},_checkForReCaptcha:function(){return!this.reCaptchaNeeded||0!=this.jElement.data("reCaptchaValidated")||!this.jElement.find(".g-recaptcha").is(":visible")||(this.jElement.find(".g-recaptcha").validationEngine("showPrompt",iptFSQM.l10n.recaptcha,"red"),this._scrollToPosition(this.jElement.find(".g-recaptcha")),!1)},intelParseFloat:function(t,i){i===s&&(i=0);var e=parseFloat(t);return isNaN(e)&&(e=i),e},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},yourOtherFunction:function(){}};var o={init:function(i){return this.each(function(){t.data(this,"plugin_"+a)||t.data(this,"plugin_"+a,new n(this,i))})}};t.fn[a]=function(i){return o[i]?o[i].apply(this,Array.prototype.slice.call(arguments,1)):("object"!=typeof i&&i?t.error("Method "+i+" does not exist on jQuery."+a):o.init.apply(this,arguments),this)}}(jQuery,window,document),jQuery(document).ready(function(t){t(".ipt_fsqm_form").iptFSQMForm()});
//# sourceMappingURL=jquery.ipt-fsqm-form.min.js.map